<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wx.watersupplierservice.dao.WaterOrderDao">
    <resultMap id="BaseResultMap" type="com.wx.watersupplierservice.po.WaterOrderPo">
        <id column="id" property="id"/>
        <result column="platform" property="platform"/>
        <result column="orderid" property="orderid"/>
        <result column="srcinnertype" property="srcinnertype"/>
        <result column="ordertype" property="ordertype"/>
        <result column="orderstatus" property="orderstatus"/>
        <result column="orderstatustime" property="orderstatustime"/>
        <result column="orderstarttime" property="orderstarttime"/>
        <result column="orderpurchasetime" property="orderpurchasetime"/>
        <result column="orderagingtype" property="orderagingtype"/>
        <result column="orderprestartdeliverytime" property="orderprestartdeliverytime"/>
        <result column="orderpreenddeliverytime" property="orderpreenddeliverytime"/>
        <result column="pickdeadline" property="pickdeadline"/>
        <result column="ordercanceltime" property="ordercanceltime"/>
        <result column="ordercancelremark" property="ordercancelremark"/>
        <result column="orgcode" property="orgcode"/>
        <result column="buyerpin" property="buyerpin"/>
        <result column="buyerfullname" property="buyerfullname"/>
        <result column="buyerfulladdress" property="buyerfulladdress"/>
        <result column="buyertelephone" property="buyertelephone"/>
        <result column="buyermobile" property="buyermobile"/>
        <result column="lastfourdigitsofbuyermobile" property="lastfourdigitsofbuyermobile"/>
        <result column="deliverystationno" property="deliverystationno"/>
        <result column="deliverystationnoisv" property="deliverystationnoisv"/>
        <result column="deliverystationname" property="deliverystationname"/>
        <result column="deliverycarrierno" property="deliverycarrierno"/>
        <result column="deliverycarriername" property="deliverycarriername"/>
        <result column="deliverybillno" property="deliverybillno"/>
        <result column="deliverypackageweight" property="deliverypackageweight"/>
        <result column="deliveryconfirmtime" property="deliveryconfirmtime"/>
        <result column="orderpaytype" property="orderpaytype"/>
        <result column="paychannel" property="paychannel"/>
        <result column="ordertotalmoney" property="ordertotalmoney"/>
        <result column="orderdiscountmoney" property="orderdiscountmoney"/>
        <result column="orderfreightmoney" property="orderfreightmoney"/>
        <result column="localdeliverymoney" property="localdeliverymoney"/>
        <result column="merchantpaymentdistancefreightmoney" property="merchantpaymentdistancefreightmoney"/>
        <result column="orderreceivablefreight" property="orderreceivablefreight"/>
        <result column="platformpointsdeductionmoney" property="platformpointsdeductionmoney"/>
        <result column="orderbuyerpayablemoney" property="orderbuyerpayablemoney"/>
        <result column="ordergoodsmoney" property="ordergoodsmoney"/>
        <result column="packagingmoney" property="packagingmoney"/>
        <result column="tips" property="tips"/>
        <result column="adjustisexists" property="adjustisexists"/>
        <result column="adjustid" property="adjustid"/>
        <result column="isgroupon" property="isgroupon"/>
        <result column="buyercoordtype" property="buyercoordtype"/>
        <result column="buyerlng" property="buyerlng"/>
        <result column="buyerlat" property="buyerlat"/>
        <result column="buyercity" property="buyercity"/>
        <result column="buyercityname" property="buyercityname"/>
        <result column="buyercountry" property="buyercountry"/>
        <result column="buyercountryname" property="buyercountryname"/>
        <result column="orderbuyerremark" property="orderbuyerremark"/>
        <result column="businesstag" property="businesstag"/>
        <result column="equipmentid" property="equipmentid"/>
        <result column="buyerpoi" property="buyerpoi"/>
        <result column="ordernum" property="ordernum"/>
        <result column="usertip" property="usertip"/>
        <result column="middlenumbindingtime" property="middlenumbindingtime"/>
        <result column="deliverinputtime" property="deliverinputtime"/>
        <result column="businesstype" property="businesstype"/>
        <result column="vendervipcardid" property="vendervipcardid"/>
        <result column="orderinvoiceopenmark" property="orderinvoiceopenmark"/>
        <result column="srcordertype" property="srcordertype"/>
        <result column="srcorderid" property="srcorderid"/>
        <result column="invoiceformtype" property="invoiceformtype"/>
        <result column="invoicetitle" property="invoicetitle"/>
        <result column="invoicedutyno" property="invoicedutyno"/>
        <result column="invoicemail" property="invoicemail"/>
        <result column="invoicemoney" property="invoicemoney"/>
        <result column="invoicecontent" property="invoicecontent"/>
        <result column="invoiceaddress" property="invoiceaddress"/>
        <result column="invoicetelno" property="invoicetelno"/>
        <result column="invoicebankname" property="invoicebankname"/>
        <result column="invoiceaccountno" property="invoiceaccountno"/>
        <result column="create_by" property="createBy"/>
        <result column="create_time" property="createTime"/>
        <result column="update_by" property="updateBy"/>
        <result column="update_time" property="updateTime"/>
    </resultMap>

    <resultMap id="OrgOrderMapForSite" type="com.wx.watersupplierservice.dto.OrderDto">
        <id column="id" property="id"/>
        <result column="platform" property="platform"/>
        <result column="orderId" property="orderid"/>
        <result column="orderStatus" property="orderstatus"/>
        <result column="orderStartTime" property="orderstarttime"/>
        <result column="orderPreStartDeliveryTime" property="orderprestartdeliverytime"/>
        <result column="orderPreEndDeliveryTime" property="orderpreenddeliverytime"/>
        <result column="pickDeadline" property="pickdeadline"/>
        <result column="orderCancelTime" property="ordercanceltime"/>
        <result column="orderCancelRemark" property="ordercancelremark"/>
        <result column="buyerPin" property="buyerpin"/>
        <result column="buyerFullName" property="buyerfullname"/>
        <result column="buyerFullAddress" property="buyerfulladdress"/>
        <result column="buyerTelephone" property="buyertelephone"/>
        <result column="buyerMobile" property="buyermobile"/>
        <result column="orderPayType" property="orderpaytype"/>
        <result column="orderTotalMoney" property="ordertotalmoney"/>
        <result column="orderGoodsMoney" property="ordergoodsmoney"/>
        <result column="orderBuyerRemark" property="orderbuyerremark"/>
        <result column="deliveryStationNo" property="deliverystationno"/>
        <result column="deliveryStationNoIsv" property="deliverystationnoisv"/>
        <result column="deliveryStationName" property="deliverystationname"/>
        <result column="orderbuyerpayablemoney" property="orderbuyerpayablemoney"/>
        <result column="deliveryConfirmTime" property="deliveryConfirmTime"/>
        <result column="orderBusinessId" property="orderBusinessId"/>
        <result column="optCode" property="optCode"/>
        <result column="remand" property="remand"/>
        <result column="orderNum" property="orderNum"/>

        <collection property="productList" ofType="com.wx.watersupplierservice.dto.OrderDto$ProductDto"
                    select="getProducts" column="id" fetchType="eager">
            <id column="productId" property="productId"/>
            <result column="skuName" property="skuName"/>
            <result column="skuCount" property="skuCount"/>
        </collection>
    </resultMap>

    <resultMap id="OrgOrderMap" type="com.wx.watersupplierservice.dto.OrderDto">
        <id column="id" property="id"/>
        <result column="platform" property="platform"/>
        <result column="orderId" property="orderid"/>
        <result column="orderStatus" property="orderstatus"/>
        <result column="orderStartTime" property="orderstarttime"/>
        <result column="orderPreStartDeliveryTime" property="orderprestartdeliverytime"/>
        <result column="orderPreEndDeliveryTime" property="orderpreenddeliverytime"/>
        <result column="pickDeadline" property="pickdeadline"/>
        <result column="orderCancelTime" property="ordercanceltime"/>
        <result column="orderCancelRemark" property="ordercancelremark"/>
        <result column="buyerPin" property="buyerpin"/>
        <result column="buyerFullName" property="buyerfullname"/>
        <result column="buyerFullAddress" property="buyerfulladdress"/>
        <result column="buyerTelephone" property="buyertelephone"/>
        <result column="buyerMobile" property="buyermobile"/>
        <result column="orderPayType" property="orderpaytype"/>
        <result column="orderTotalMoney" property="ordertotalmoney"/>
        <result column="orderGoodsMoney" property="ordergoodsmoney"/>
        <result column="orderBuyerRemark" property="orderbuyerremark"/>
        <result column="deliveryStationNo" property="deliverystationno"/>
        <result column="deliveryStationNoIsv" property="deliverystationnoisv"/>
        <result column="deliveryStationName" property="deliverystationname"/>
        <result column="orderbuyerpayablemoney" property="orderbuyerpayablemoney"/>
        <result column="deliveryConfirmTime" property="deliveryConfirmTime"/>
        <collection property="productList" ofType="com.wx.watersupplierservice.dto.OrderDto$ProductDto"
                    select="getProducts" column="id" fetchType="eager" >
            <id column="productId" property="productId"/>
            <result column="skuName" property="skuName"/>
            <result column="skuCount" property="skuCount"/>
            <result column="skuJdPrice" property="skuJdPrice"/>
        </collection>
    </resultMap>

    <sql id="Table_Name">
        water_supplier.water_order
    </sql>

    <sql id="Base_Column">
        id,
        platform,
        orderid,
        srcinnertype,
        ordertype,
        orderstatus,
        orderstatustime,
        orderstarttime,
        orderpurchasetime,
        orderagingtype,
        orderprestartdeliverytime,
        orderpreenddeliverytime,
        pickdeadline,
        ordercanceltime,
        ordercancelremark,
        orgcode,
        buyerpin,
        buyerfullname,
        buyerfulladdress,
        buyertelephone,
        buyermobile,
        lastfourdigitsofbuyermobile,
        deliverystationno,
        deliverystationnoisv,
        deliverystationname,
        deliverycarrierno,
        deliverycarriername,
        deliverybillno,
        deliverypackageweight,
        deliveryconfirmtime,
        orderpaytype,
        paychannel,
        ordertotalmoney,
        orderdiscountmoney,
        orderfreightmoney,
        localdeliverymoney,
        merchantpaymentdistancefreightmoney,
        orderreceivablefreight,
        platformpointsdeductionmoney,
        orderbuyerpayablemoney,
        ordergoodsmoney,
        packagingmoney,
        tips,
        adjustisexists,
        adjustid,
        isgroupon,
        buyercoordtype,
        buyerlng,
        buyerlat,
        buyercity,
        buyercityname,
        buyercountry,
        buyercountryname,
        orderbuyerremark,
        businesstag,
        equipmentid,
        buyerpoi,
        ordernum,
        usertip,
        middlenumbindingtime,
        deliverinputtime,
        businesstype,
        vendervipcardid,
        orderinvoiceopenmark,
        srcordertype,
        srcorderid,
        invoiceformtype,
        invoicetitle,
        invoicedutyno,
        invoicemail,
        invoicemoney,
        invoicecontent,
        invoiceaddress,
        invoicetelno,
        invoicebankname,
        invoiceaccountno,
        create_by,
        create_time,
        update_by,
        update_time
    </sql>

    <sql id="Base_Where">
        <trim suffixOverrides="AND">
            <if test="orderId != null">
                AND id=#{id}
            </if>
            <if test="platform != null">
                AND platform=#{platform}
            </if>
            <if test="orderid != null">
                AND orderid=#{orderid}
            </if>
            <if test="srcinnertype != null">
                AND srcinnertype=#{srcinnertype}
            </if>
            <if test="ordertype != null">
                AND ordertype=#{ordertype}
            </if>
            <if test="orderstatus != null">
                AND orderstatus=#{orderstatus}
            </if>
            <if test="orderstatustime != null">
                AND orderstatustime=#{orderstatustime}
            </if>
            <if test="orderstarttime != null">
                AND orderstarttime=#{orderstarttime}
            </if>
            <if test="orderpurchasetime != null">
                AND orderpurchasetime=#{orderpurchasetime}
            </if>
            <if test="orderagingtype != null">
                AND orderagingtype=#{orderagingtype}
            </if>
            <if test="orderprestartdeliverytime != null">
                AND orderprestartdeliverytime=#{orderprestartdeliverytime}
            </if>
            <if test="orderpreenddeliverytime != null">
                AND orderpreenddeliverytime=#{orderpreenddeliverytime}
            </if>
            <if test="pickdeadline != null">
                AND pickdeadline=#{pickdeadline}
            </if>
            <if test="ordercanceltime != null">
                AND ordercanceltime=#{ordercanceltime}
            </if>
            <if test="ordercancelremark != null">
                AND ordercancelremark=#{ordercancelremark}
            </if>
            <if test="orgcode != null">
                AND orgcode=#{orgcode}
            </if>
            <if test="buyerpin != null">
                AND buyerpin=#{buyerpin}
            </if>
            <if test="buyerfullname != null">
                AND buyerfullname=#{buyerfullname}
            </if>
            <if test="buyerfulladdress != null">
                AND buyerfulladdress=#{buyerfulladdress}
            </if>
            <if test="buyertelephone != null">
                AND buyertelephone=#{buyertelephone}
            </if>
            <if test="buyermobile != null">
                AND buyermobile=#{buyermobile}
            </if>
            <if test="lastfourdigitsofbuyermobile != null">
                AND lastfourdigitsofbuyermobile=#{lastfourdigitsofbuyermobile}
            </if>
            <if test="deliverystationno != null">
                AND deliverystationno=#{deliverystationno}
            </if>
            <if test="deliverystationnoisv != null">
                AND deliverystationnoisv=#{deliverystationnoisv}
            </if>
            <if test="deliverystationname != null">
                AND deliverystationname=#{deliverystationname}
            </if>
            <if test="deliverycarrierno != null">
                AND deliverycarrierno=#{deliverycarrierno}
            </if>
            <if test="deliverycarriername != null">
                AND deliverycarriername=#{deliverycarriername}
            </if>
            <if test="deliverybillno != null">
                AND deliverybillno=#{deliverybillno}
            </if>
            <if test="deliverypackageweight != null">
                AND deliverypackageweight=#{deliverypackageweight}
            </if>
            <if test="deliveryconfirmtime != null">
                AND deliveryconfirmtime=#{deliveryconfirmtime}
            </if>
            <if test="orderpaytype != null">
                AND orderpaytype=#{orderpaytype}
            </if>
            <if test="paychannel != null">
                AND paychannel=#{paychannel}
            </if>
            <if test="ordertotalmoney != null">
                AND ordertotalmoney=#{ordertotalmoney}
            </if>
            <if test="orderdiscountmoney != null">
                AND orderdiscountmoney=#{orderdiscountmoney}
            </if>
            <if test="orderfreightmoney != null">
                AND orderfreightmoney=#{orderfreightmoney}
            </if>
            <if test="localdeliverymoney != null">
                AND localdeliverymoney=#{localdeliverymoney}
            </if>
            <if test="merchantpaymentdistancefreightmoney != null">
                AND merchantpaymentdistancefreightmoney=#{merchantpaymentdistancefreightmoney}
            </if>
            <if test="orderreceivablefreight != null">
                AND orderreceivablefreight=#{orderreceivablefreight}
            </if>
            <if test="platformpointsdeductionmoney != null">
                AND platformpointsdeductionmoney=#{platformpointsdeductionmoney}
            </if>
            <if test="orderbuyerpayablemoney != null">
                AND orderbuyerpayablemoney=#{orderbuyerpayablemoney}
            </if>
            <if test="ordergoodsmoney != null">
                AND ordergoodsmoney=#{ordergoodsmoney}
            </if>
            <if test="packagingmoney != null">
                AND packagingmoney=#{packagingmoney}
            </if>
            <if test="tips != null">
                AND tips=#{tips}
            </if>
            <if test="adjustisexists != null">
                AND adjustisexists=#{adjustisexists}
            </if>
            <if test="adjustid != null">
                AND adjustid=#{adjustid}
            </if>
            <if test="isgroupon != null">
                AND isgroupon=#{isgroupon}
            </if>
            <if test="buyercoordtype != null">
                AND buyercoordtype=#{buyercoordtype}
            </if>
            <if test="buyerlng != null">
                AND buyerlng=#{buyerlng}
            </if>
            <if test="buyerlat != null">
                AND buyerlat=#{buyerlat}
            </if>
            <if test="buyercity != null">
                AND buyercity=#{buyercity}
            </if>
            <if test="buyercityname != null">
                AND buyercityname=#{buyercityname}
            </if>
            <if test="buyercountry != null">
                AND buyercountry=#{buyercountry}
            </if>
            <if test="buyercountryname != null">
                AND buyercountryname=#{buyercountryname}
            </if>
            <if test="orderbuyerremark != null">
                AND orderbuyerremark=#{orderbuyerremark}
            </if>
            <if test="businesstag != null">
                AND businesstag=#{businesstag}
            </if>
            <if test="equipmentid != null">
                AND equipmentid=#{equipmentid}
            </if>
            <if test="buyerpoi != null">
                AND buyerpoi=#{buyerpoi}
            </if>
            <if test="ordernum != null">
                AND ordernum=#{ordernum}
            </if>
            <if test="usertip != null">
                AND usertip=#{usertip}
            </if>
            <if test="middlenumbindingtime != null">
                AND middlenumbindingtime=#{middlenumbindingtime}
            </if>
            <if test="deliverinputtime != null">
                AND deliverinputtime=#{deliverinputtime}
            </if>
            <if test="businesstype != null">
                AND businesstype=#{businesstype}
            </if>
            <if test="vendervipcardid != null">
                AND vendervipcardid=#{vendervipcardid}
            </if>
            <if test="orderinvoiceopenmark != null">
                AND orderinvoiceopenmark=#{orderinvoiceopenmark}
            </if>
            <if test="srcordertype != null">
                AND srcordertype=#{srcordertype}
            </if>
            <if test="srcorderid != null">
                AND srcorderid=#{srcorderid}
            </if>
            <if test="invoiceformtype != null">
                AND invoiceformtype=#{invoiceformtype}
            </if>
            <if test="invoicetitle != null">
                AND invoicetitle=#{invoicetitle}
            </if>
            <if test="invoicedutyno != null">
                AND invoicedutyno=#{invoicedutyno}
            </if>
            <if test="invoicemail != null">
                AND invoicemail=#{invoicemail}
            </if>
            <if test="invoicemoney != null">
                AND invoicemoney=#{invoicemoney}
            </if>
            <if test="invoicecontent != null">
                AND invoicecontent=#{invoicecontent}
            </if>
            <if test="invoiceaddress != null">
                AND invoiceaddress=#{invoiceaddress}
            </if>
            <if test="invoicetelno != null">
                AND invoicetelno=#{invoicetelno}
            </if>
            <if test="invoicebankname != null">
                AND invoicebankname=#{invoicebankname}
            </if>
            <if test="invoiceaccountno != null">
                AND invoiceaccountno=#{invoiceaccountno}
            </if>
            <if test="createBy != null">
                AND create_by=#{createBy}
            </if>
            <if test="createTime != null">
                AND create_time=#{createTime}
            </if>
            <if test="updateBy != null">
                AND update_by=#{updateBy}
            </if>
            <if test="updateTime != null">
                AND update_time=#{updateTime}
            </if>
        </trim>
    </sql>

    <sql id="Base_Select">
        select
        <include refid="Base_Column"/>
        from
        <include refid="Table_Name"/>
        <where>
            <include refid="Base_Where"/>
        </where>
    </sql>

    <!-- 单条插入 -->
    <insert id="insert" parameterType="com.wx.watersupplierservice.po.WaterOrderPo" useGeneratedKeys="true"
            keyProperty="id">
        insert into
        <include refid="Table_Name"/>
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">
                id,
            </if>
            <if test="platform != null">
                platform,
            </if>
            <if test="orderid != null">
                orderid,
            </if>
            <if test="srcinnertype != null">
                srcinnertype,
            </if>
            <if test="ordertype != null">
                ordertype,
            </if>
            <if test="orderstatus != null">
                orderstatus,
            </if>
            <if test="orderstatustime != null">
                orderstatustime,
            </if>
            <if test="orderstarttime != null">
                orderstarttime,
            </if>
            <if test="orderpurchasetime != null">
                orderpurchasetime,
            </if>
            <if test="orderagingtype != null">
                orderagingtype,
            </if>
            <if test="orderprestartdeliverytime != null">
                orderprestartdeliverytime,
            </if>
            <if test="orderpreenddeliverytime != null">
                orderpreenddeliverytime,
            </if>
            <if test="pickdeadline != null">
                pickdeadline,
            </if>
            <if test="ordercanceltime != null">
                ordercanceltime,
            </if>
            <if test="ordercancelremark != null">
                ordercancelremark,
            </if>
            <if test="orgcode != null">
                orgcode,
            </if>
            <if test="buyerpin != null">
                buyerpin,
            </if>
            <if test="buyerfullname != null">
                buyerfullname,
            </if>
            <if test="buyerfulladdress != null">
                buyerfulladdress,
            </if>
            <if test="buyertelephone != null">
                buyertelephone,
            </if>
            <if test="buyermobile != null">
                buyermobile,
            </if>
            <if test="lastfourdigitsofbuyermobile != null">
                lastfourdigitsofbuyermobile,
            </if>
            <if test="deliverystationno != null">
                deliverystationno,
            </if>
            <if test="deliverystationnoisv != null">
                deliverystationnoisv,
            </if>
            <if test="deliverystationname != null">
                deliverystationname,
            </if>
            <if test="deliverycarrierno != null">
                deliverycarrierno,
            </if>
            <if test="deliverycarriername != null">
                deliverycarriername,
            </if>
            <if test="deliverybillno != null">
                deliverybillno,
            </if>
            <if test="deliverypackageweight != null">
                deliverypackageweight,
            </if>
            <if test="deliveryconfirmtime != null">
                deliveryconfirmtime,
            </if>
            <if test="orderpaytype != null">
                orderpaytype,
            </if>
            <if test="paychannel != null">
                paychannel,
            </if>
            <if test="ordertotalmoney != null">
                ordertotalmoney,
            </if>
            <if test="orderdiscountmoney != null">
                orderdiscountmoney,
            </if>
            <if test="orderfreightmoney != null">
                orderfreightmoney,
            </if>
            <if test="localdeliverymoney != null">
                localdeliverymoney,
            </if>
            <if test="merchantpaymentdistancefreightmoney != null">
                merchantpaymentdistancefreightmoney,
            </if>
            <if test="orderreceivablefreight != null">
                orderreceivablefreight,
            </if>
            <if test="platformpointsdeductionmoney != null">
                platformpointsdeductionmoney,
            </if>
            <if test="orderbuyerpayablemoney != null">
                orderbuyerpayablemoney,
            </if>
            <if test="ordergoodsmoney != null">
                ordergoodsmoney,
            </if>
            <if test="packagingmoney != null">
                packagingmoney,
            </if>
            <if test="tips != null">
                tips,
            </if>
            <if test="adjustisexists != null">
                adjustisexists,
            </if>
            <if test="adjustid != null">
                adjustid,
            </if>
            <if test="isgroupon != null">
                isgroupon,
            </if>
            <if test="buyercoordtype != null">
                buyercoordtype,
            </if>
            <if test="buyerlng != null">
                buyerlng,
            </if>
            <if test="buyerlat != null">
                buyerlat,
            </if>
            <if test="buyercity != null">
                buyercity,
            </if>
            <if test="buyercityname != null">
                buyercityname,
            </if>
            <if test="buyercountry != null">
                buyercountry,
            </if>
            <if test="buyercountryname != null">
                buyercountryname,
            </if>
            <if test="orderbuyerremark != null">
                orderbuyerremark,
            </if>
            <if test="businesstag != null">
                businesstag,
            </if>
            <if test="equipmentid != null">
                equipmentid,
            </if>
            <if test="buyerpoi != null">
                buyerpoi,
            </if>
            <if test="ordernum != null">
                ordernum,
            </if>
            <if test="usertip != null">
                usertip,
            </if>
            <if test="middlenumbindingtime != null">
                middlenumbindingtime,
            </if>
            <if test="deliverinputtime != null">
                deliverinputtime,
            </if>
            <if test="businesstype != null">
                businesstype,
            </if>
            <if test="vendervipcardid != null">
                vendervipcardid,
            </if>
            <if test="orderinvoiceopenmark != null">
                orderinvoiceopenmark,
            </if>
            <if test="srcordertype != null">
                srcordertype,
            </if>
            <if test="srcorderid != null">
                srcorderid,
            </if>
            <if test="invoiceformtype != null">
                invoiceformtype,
            </if>
            <if test="invoicetitle != null">
                invoicetitle,
            </if>
            <if test="invoicedutyno != null">
                invoicedutyno,
            </if>
            <if test="invoicemail != null">
                invoicemail,
            </if>
            <if test="invoicemoney != null">
                invoicemoney,
            </if>
            <if test="invoicecontent != null">
                invoicecontent,
            </if>
            <if test="invoiceaddress != null">
                invoiceaddress,
            </if>
            <if test="invoicetelno != null">
                invoicetelno,
            </if>
            <if test="invoicebankname != null">
                invoicebankname,
            </if>
            <if test="invoiceaccountno != null">
                invoiceaccountno,
            </if>
            <if test="createBy != null">
                create_by,
            </if>
            <if test="updateBy != null">
                update_by,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null">
                #{id},
            </if>
            <if test="platform != null">
                #{platform},
            </if>
            <if test="orderid != null">
                #{orderid},
            </if>
            <if test="srcinnertype != null">
                #{srcinnertype},
            </if>
            <if test="ordertype != null">
                #{ordertype},
            </if>
            <if test="orderstatus != null">
                #{orderstatus},
            </if>
            <if test="orderstatustime != null">
                #{orderstatustime},
            </if>
            <if test="orderstarttime != null">
                #{orderstarttime},
            </if>
            <if test="orderpurchasetime != null">
                #{orderpurchasetime},
            </if>
            <if test="orderagingtype != null">
                #{orderagingtype},
            </if>
            <if test="orderprestartdeliverytime != null">
                #{orderprestartdeliverytime},
            </if>
            <if test="orderpreenddeliverytime != null">
                #{orderpreenddeliverytime},
            </if>
            <if test="pickdeadline != null">
                #{pickdeadline},
            </if>
            <if test="ordercanceltime != null">
                #{ordercanceltime},
            </if>
            <if test="ordercancelremark != null">
                #{ordercancelremark},
            </if>
            <if test="orgcode != null">
                #{orgcode},
            </if>
            <if test="buyerpin != null">
                #{buyerpin},
            </if>
            <if test="buyerfullname != null">
                #{buyerfullname},
            </if>
            <if test="buyerfulladdress != null">
                #{buyerfulladdress},
            </if>
            <if test="buyertelephone != null">
                #{buyertelephone},
            </if>
            <if test="buyermobile != null">
                #{buyermobile},
            </if>
            <if test="lastfourdigitsofbuyermobile != null">
                #{lastfourdigitsofbuyermobile},
            </if>
            <if test="deliverystationno != null">
                #{deliverystationno},
            </if>
            <if test="deliverystationnoisv != null">
                #{deliverystationnoisv},
            </if>
            <if test="deliverystationname != null">
                #{deliverystationname},
            </if>
            <if test="deliverycarrierno != null">
                #{deliverycarrierno},
            </if>
            <if test="deliverycarriername != null">
                #{deliverycarriername},
            </if>
            <if test="deliverybillno != null">
                #{deliverybillno},
            </if>
            <if test="deliverypackageweight != null">
                #{deliverypackageweight},
            </if>
            <if test="deliveryconfirmtime != null">
                #{deliveryconfirmtime},
            </if>
            <if test="orderpaytype != null">
                #{orderpaytype},
            </if>
            <if test="paychannel != null">
                #{paychannel},
            </if>
            <if test="ordertotalmoney != null">
                #{ordertotalmoney},
            </if>
            <if test="orderdiscountmoney != null">
                #{orderdiscountmoney},
            </if>
            <if test="orderfreightmoney != null">
                #{orderfreightmoney},
            </if>
            <if test="localdeliverymoney != null">
                #{localdeliverymoney},
            </if>
            <if test="merchantpaymentdistancefreightmoney != null">
                #{merchantpaymentdistancefreightmoney},
            </if>
            <if test="orderreceivablefreight != null">
                #{orderreceivablefreight},
            </if>
            <if test="platformpointsdeductionmoney != null">
                #{platformpointsdeductionmoney},
            </if>
            <if test="orderbuyerpayablemoney != null">
                #{orderbuyerpayablemoney},
            </if>
            <if test="ordergoodsmoney != null">
                #{ordergoodsmoney},
            </if>
            <if test="packagingmoney != null">
                #{packagingmoney},
            </if>
            <if test="tips != null">
                #{tips},
            </if>
            <if test="adjustisexists != null">
                #{adjustisexists},
            </if>
            <if test="adjustid != null">
                #{adjustid},
            </if>
            <if test="isgroupon != null">
                #{isgroupon},
            </if>
            <if test="buyercoordtype != null">
                #{buyercoordtype},
            </if>
            <if test="buyerlng != null">
                #{buyerlng},
            </if>
            <if test="buyerlat != null">
                #{buyerlat},
            </if>
            <if test="buyercity != null">
                #{buyercity},
            </if>
            <if test="buyercityname != null">
                #{buyercityname},
            </if>
            <if test="buyercountry != null">
                #{buyercountry},
            </if>
            <if test="buyercountryname != null">
                #{buyercountryname},
            </if>
            <if test="orderbuyerremark != null">
                #{orderbuyerremark},
            </if>
            <if test="businesstag != null">
                #{businesstag},
            </if>
            <if test="equipmentid != null">
                #{equipmentid},
            </if>
            <if test="buyerpoi != null">
                #{buyerpoi},
            </if>
            <if test="ordernum != null">
                #{ordernum},
            </if>
            <if test="usertip != null">
                #{usertip},
            </if>
            <if test="middlenumbindingtime != null">
                #{middlenumbindingtime},
            </if>
            <if test="deliverinputtime != null">
                #{deliverinputtime},
            </if>
            <if test="businesstype != null">
                #{businesstype},
            </if>
            <if test="vendervipcardid != null">
                #{vendervipcardid},
            </if>
            <if test="orderinvoiceopenmark != null">
                #{orderinvoiceopenmark},
            </if>
            <if test="srcordertype != null">
                #{srcordertype},
            </if>
            <if test="srcorderid != null">
                #{srcorderid},
            </if>
            <if test="invoiceformtype != null">
                #{invoiceformtype},
            </if>
            <if test="invoicetitle != null">
                #{invoicetitle},
            </if>
            <if test="invoicedutyno != null">
                #{invoicedutyno},
            </if>
            <if test="invoicemail != null">
                #{invoicemail},
            </if>
            <if test="invoicemoney != null">
                #{invoicemoney},
            </if>
            <if test="invoicecontent != null">
                #{invoicecontent},
            </if>
            <if test="invoiceaddress != null">
                #{invoiceaddress},
            </if>
            <if test="invoicetelno != null">
                #{invoicetelno},
            </if>
            <if test="invoicebankname != null">
                #{invoicebankname},
            </if>
            <if test="invoiceaccountno != null">
                #{invoiceaccountno},
            </if>
            <if test="createBy != null">
                #{createBy},
            </if>
            <if test="updateBy != null">
                #{updateBy},
            </if>
        </trim>
    </insert>

    <!-- 批量插入 -->
    <insert id="insertList" parameterType="java.util.List">
        insert into
        <include refid="Table_Name"/>
        <trim prefix="(" suffix=")" suffixOverrides=",">
            platform,
            orderid,
            srcinnertype,
            ordertype,
            orderstatus,
            orderstatustime,
            orderstarttime,
            orderpurchasetime,
            orderagingtype,
            orderprestartdeliverytime,
            orderpreenddeliverytime,
            pickdeadline,
            ordercanceltime,
            ordercancelremark,
            orgcode,
            buyerpin,
            buyerfullname,
            buyerfulladdress,
            buyertelephone,
            buyermobile,
            lastfourdigitsofbuyermobile,
            deliverystationno,
            deliverystationnoisv,
            deliverystationname,
            deliverycarrierno,
            deliverycarriername,
            deliverybillno,
            deliverypackageweight,
            deliveryconfirmtime,
            orderpaytype,
            paychannel,
            ordertotalmoney,
            orderdiscountmoney,
            orderfreightmoney,
            localdeliverymoney,
            merchantpaymentdistancefreightmoney,
            orderreceivablefreight,
            platformpointsdeductionmoney,
            orderbuyerpayablemoney,
            ordergoodsmoney,
            packagingmoney,
            tips,
            adjustisexists,
            adjustid,
            isgroupon,
            buyercoordtype,
            buyerlng,
            buyerlat,
            buyercity,
            buyercityname,
            buyercountry,
            buyercountryname,
            orderbuyerremark,
            businesstag,
            equipmentid,
            buyerpoi,
            ordernum,
            usertip,
            middlenumbindingtime,
            deliverinputtime,
            businesstype,
            vendervipcardid,
            orderinvoiceopenmark,
            srcordertype,
            srcorderid,
            invoiceformtype,
            invoicetitle,
            invoicedutyno,
            invoicemail,
            invoicemoney,
            invoicecontent,
            invoiceaddress,
            invoicetelno,
            invoicebankname,
            invoiceaccountno,
            create_by,
            update_by,
        </trim>
        values
        <foreach collection="list" item="item" separator=",">
            <trim prefix="(" suffix=")" suffixOverrides=",">
                #{item.platform},
                #{item.orderid},
                #{item.srcinnertype},
                #{item.ordertype},
                #{item.orderstatus},
                #{item.orderstatustime},
                #{item.orderstarttime},
                #{item.orderpurchasetime},
                #{item.orderagingtype},
                #{item.orderprestartdeliverytime},
                #{item.orderpreenddeliverytime},
                #{item.pickdeadline},
                #{item.ordercanceltime},
                #{item.ordercancelremark},
                #{item.orgcode},
                #{item.buyerpin},
                #{item.buyerfullname},
                #{item.buyerfulladdress},
                #{item.buyertelephone},
                #{item.buyermobile},
                #{item.lastfourdigitsofbuyermobile},
                #{item.deliverystationno},
                #{item.deliverystationnoisv},
                #{item.deliverystationname},
                #{item.deliverycarrierno},
                #{item.deliverycarriername},
                #{item.deliverybillno},
                #{item.deliverypackageweight},
                #{item.deliveryconfirmtime},
                #{item.orderpaytype},
                #{item.paychannel},
                #{item.ordertotalmoney},
                #{item.orderdiscountmoney},
                #{item.orderfreightmoney},
                #{item.localdeliverymoney},
                #{item.merchantpaymentdistancefreightmoney},
                #{item.orderreceivablefreight},
                #{item.platformpointsdeductionmoney},
                #{item.orderbuyerpayablemoney},
                #{item.ordergoodsmoney},
                #{item.packagingmoney},
                #{item.tips},
                #{item.adjustisexists},
                #{item.adjustid},
                #{item.isgroupon},
                #{item.buyercoordtype},
                #{item.buyerlng},
                #{item.buyerlat},
                #{item.buyercity},
                #{item.buyercityname},
                #{item.buyercountry},
                #{item.buyercountryname},
                #{item.orderbuyerremark},
                #{item.businesstag},
                #{item.equipmentid},
                #{item.buyerpoi},
                #{item.ordernum},
                #{item.usertip},
                #{item.middlenumbindingtime},
                #{item.deliverinputtime},
                #{item.businesstype},
                #{item.vendervipcardid},
                #{item.orderinvoiceopenmark},
                #{item.srcordertype},
                #{item.srcorderid},
                #{item.invoiceformtype},
                #{item.invoicetitle},
                #{item.invoicedutyno},
                #{item.invoicemail},
                #{item.invoicemoney},
                #{item.invoicecontent},
                #{item.invoiceaddress},
                #{item.invoicetelno},
                #{item.invoicebankname},
                #{item.invoiceaccountno},
                #{item.createBy},
                #{item.updateBy},
            </trim>
        </foreach>
    </insert>

    <!-- 根据主键批量更新 -->
    <update id="updateList" parameterType="java.util.List">
        <foreach collection="list" item="item" separator=";">
            update
            <include refid="Table_Name"/>
            <set>
                <if test="item.platform != null">
                    platform=#{item.platform},
                </if>
                <if test="item.orderid != null">
                    orderid=#{item.orderid},
                </if>
                <if test="item.srcinnertype != null">
                    srcinnertype=#{item.srcinnertype},
                </if>
                <if test="item.ordertype != null">
                    ordertype=#{item.ordertype},
                </if>
                <if test="item.orderstatus != null">
                    orderstatus=#{item.orderstatus},
                </if>
                <if test="item.orderstatustime != null">
                    orderstatustime=#{item.orderstatustime},
                </if>
                <if test="item.orderstarttime != null">
                    orderstarttime=#{item.orderstarttime},
                </if>
                <if test="item.orderpurchasetime != null">
                    orderpurchasetime=#{item.orderpurchasetime},
                </if>
                <if test="item.orderagingtype != null">
                    orderagingtype=#{item.orderagingtype},
                </if>
                <if test="item.orderprestartdeliverytime != null">
                    orderprestartdeliverytime=#{item.orderprestartdeliverytime},
                </if>
                <if test="item.orderpreenddeliverytime != null">
                    orderpreenddeliverytime=#{item.orderpreenddeliverytime},
                </if>
                <if test="item.pickdeadline != null">
                    pickdeadline=#{item.pickdeadline},
                </if>
                <if test="item.ordercanceltime != null">
                    ordercanceltime=#{item.ordercanceltime},
                </if>
                <if test="item.ordercancelremark != null">
                    ordercancelremark=#{item.ordercancelremark},
                </if>
                <if test="item.orgcode != null">
                    orgcode=#{item.orgcode},
                </if>
                <if test="item.buyerpin != null">
                    buyerpin=#{item.buyerpin},
                </if>
                <if test="item.buyerfullname != null">
                    buyerfullname=#{item.buyerfullname},
                </if>
                <if test="item.buyerfulladdress != null">
                    buyerfulladdress=#{item.buyerfulladdress},
                </if>
                <if test="item.buyertelephone != null">
                    buyertelephone=#{item.buyertelephone},
                </if>
                <if test="item.buyermobile != null">
                    buyermobile=#{item.buyermobile},
                </if>
                <if test="item.lastfourdigitsofbuyermobile != null">
                    lastfourdigitsofbuyermobile=#{item.lastfourdigitsofbuyermobile},
                </if>
                <if test="item.deliverystationno != null">
                    deliverystationno=#{item.deliverystationno},
                </if>
                <if test="item.deliverystationnoisv != null">
                    deliverystationnoisv=#{item.deliverystationnoisv},
                </if>
                <if test="item.deliverystationname != null">
                    deliverystationname=#{item.deliverystationname},
                </if>
                <if test="item.deliverycarrierno != null">
                    deliverycarrierno=#{item.deliverycarrierno},
                </if>
                <if test="item.deliverycarriername != null">
                    deliverycarriername=#{item.deliverycarriername},
                </if>
                <if test="item.deliverybillno != null">
                    deliverybillno=#{item.deliverybillno},
                </if>
                <if test="item.deliverypackageweight != null">
                    deliverypackageweight=#{item.deliverypackageweight},
                </if>
                <if test="item.deliveryconfirmtime != null">
                    deliveryconfirmtime=#{item.deliveryconfirmtime},
                </if>
                <if test="item.orderpaytype != null">
                    orderpaytype=#{item.orderpaytype},
                </if>
                <if test="item.paychannel != null">
                    paychannel=#{item.paychannel},
                </if>
                <if test="item.ordertotalmoney != null">
                    ordertotalmoney=#{item.ordertotalmoney},
                </if>
                <if test="item.orderdiscountmoney != null">
                    orderdiscountmoney=#{item.orderdiscountmoney},
                </if>
                <if test="item.orderfreightmoney != null">
                    orderfreightmoney=#{item.orderfreightmoney},
                </if>
                <if test="item.localdeliverymoney != null">
                    localdeliverymoney=#{item.localdeliverymoney},
                </if>
                <if test="item.merchantpaymentdistancefreightmoney != null">
                    merchantpaymentdistancefreightmoney=#{item.merchantpaymentdistancefreightmoney},
                </if>
                <if test="item.orderreceivablefreight != null">
                    orderreceivablefreight=#{item.orderreceivablefreight},
                </if>
                <if test="item.platformpointsdeductionmoney != null">
                    platformpointsdeductionmoney=#{item.platformpointsdeductionmoney},
                </if>
                <if test="item.orderbuyerpayablemoney != null">
                    orderbuyerpayablemoney=#{item.orderbuyerpayablemoney},
                </if>
                <if test="item.ordergoodsmoney != null">
                    ordergoodsmoney=#{item.ordergoodsmoney},
                </if>
                <if test="item.packagingmoney != null">
                    packagingmoney=#{item.packagingmoney},
                </if>
                <if test="item.tips != null">
                    tips=#{item.tips},
                </if>
                <if test="item.adjustisexists != null">
                    adjustisexists=#{item.adjustisexists},
                </if>
                <if test="item.adjustid != null">
                    adjustid=#{item.adjustid},
                </if>
                <if test="item.isgroupon != null">
                    isgroupon=#{item.isgroupon},
                </if>
                <if test="item.buyercoordtype != null">
                    buyercoordtype=#{item.buyercoordtype},
                </if>
                <if test="item.buyerlng != null">
                    buyerlng=#{item.buyerlng},
                </if>
                <if test="item.buyerlat != null">
                    buyerlat=#{item.buyerlat},
                </if>
                <if test="item.buyercity != null">
                    buyercity=#{item.buyercity},
                </if>
                <if test="item.buyercityname != null">
                    buyercityname=#{item.buyercityname},
                </if>
                <if test="item.buyercountry != null">
                    buyercountry=#{item.buyercountry},
                </if>
                <if test="item.buyercountryname != null">
                    buyercountryname=#{item.buyercountryname},
                </if>
                <if test="item.orderbuyerremark != null">
                    orderbuyerremark=#{item.orderbuyerremark},
                </if>
                <if test="item.businesstag != null">
                    businesstag=#{item.businesstag},
                </if>
                <if test="item.equipmentid != null">
                    equipmentid=#{item.equipmentid},
                </if>
                <if test="item.buyerpoi != null">
                    buyerpoi=#{item.buyerpoi},
                </if>
                <if test="item.ordernum != null">
                    ordernum=#{item.ordernum},
                </if>
                <if test="item.usertip != null">
                    usertip=#{item.usertip},
                </if>
                <if test="item.middlenumbindingtime != null">
                    middlenumbindingtime=#{item.middlenumbindingtime},
                </if>
                <if test="item.deliverinputtime != null">
                    deliverinputtime=#{item.deliverinputtime},
                </if>
                <if test="item.businesstype != null">
                    businesstype=#{item.businesstype},
                </if>
                <if test="item.vendervipcardid != null">
                    vendervipcardid=#{item.vendervipcardid},
                </if>
                <if test="item.orderinvoiceopenmark != null">
                    orderinvoiceopenmark=#{item.orderinvoiceopenmark},
                </if>
                <if test="item.srcordertype != null">
                    srcordertype=#{item.srcordertype},
                </if>
                <if test="item.srcorderid != null">
                    srcorderid=#{item.srcorderid},
                </if>
                <if test="item.invoiceformtype != null">
                    invoiceformtype=#{item.invoiceformtype},
                </if>
                <if test="item.invoicetitle != null">
                    invoicetitle=#{item.invoicetitle},
                </if>
                <if test="item.invoicedutyno != null">
                    invoicedutyno=#{item.invoicedutyno},
                </if>
                <if test="item.invoicemail != null">
                    invoicemail=#{item.invoicemail},
                </if>
                <if test="item.invoicemoney != null">
                    invoicemoney=#{item.invoicemoney},
                </if>
                <if test="item.invoicecontent != null">
                    invoicecontent=#{item.invoicecontent},
                </if>
                <if test="item.invoiceaddress != null">
                    invoiceaddress=#{item.invoiceaddress},
                </if>
                <if test="item.invoicetelno != null">
                    invoicetelno=#{item.invoicetelno},
                </if>
                <if test="item.invoicebankname != null">
                    invoicebankname=#{item.invoicebankname},
                </if>
                <if test="item.invoiceaccountno != null">
                    invoiceaccountno=#{item.invoiceaccountno},
                </if>
                <if test="item.createBy != null">
                    create_by=#{item.createBy},
                </if>
                <if test="item.updateBy != null">
                    update_by=#{item.updateBy},
                </if>
            </set>
            where
                id=#{item.id}
        </foreach>
    </update>

    <!-- 查询单表符合条件总条数 -->
    <select id="count" parameterType="com.wx.watersupplierservice.po.WaterOrderPo" resultType="int">
        select count(1) from
        <include refid="Table_Name"/>
        <where>
            <include refid="Base_Where"/>
        </where>
    </select>

    <!-- 查询符合条件的一条记录 -->
    <select id="selectOne" parameterType="com.wx.watersupplierservice.po.WaterOrderPo" resultMap="BaseResultMap">
        <include refid="Base_Select"/>
        limit 1
    </select>

    <!-- 查询符合条件的记录 -->
    <select id="selectList" parameterType="com.wx.watersupplierservice.po.WaterOrderPo" resultMap="BaseResultMap">
        <include refid="Base_Select"/>
    </select>

    <!-- 查询符合条件的记录  锁定符合条件的行-->
    <select id="selectForUpdate" parameterType="com.wx.watersupplierservice.po.WaterOrderPo" resultMap="BaseResultMap">
        <include refid="Base_Select"/>
        for update
    </select>
    <select id="getProducts" parameterType="java.lang.Integer" resultType="com.wx.watersupplierservice.dto.OrderDto$ProductDto">
        select
            wop.product_id as productId,
            wop.skuName,
            wop.skuCount,
            wop.skuJdPrice
        from
            water_order_product wop
        where
            wop.orderId = #{id}
    </select>

    <select id="getOrgOrderList" parameterType="com.wx.watersupplierservice.req.OrderListReq" resultMap="OrgOrderMap">
    SELECT
        wo.id,
        wo.orderId,
        wo.platform,
        wo.orderStatus,
        wo.orderStartTime,
        wo.pickDeadline,
        wo.orderPreStartDeliveryTime,
        wo.orderPreEndDeliveryTime,
        wo.orderCancelTime,
        wo.orderCancelRemark,
        wo.buyerPin,
        wo.buyerFullName,
        wo.buyerFullAddress,
        wo.buyerTelephone,
        wo.buyerMobile,
        wo.orderPayType,
        wo.orderTotalMoney,
        wo.orderGoodsMoney,
        wo.orderBuyerRemark,
        wo.deliveryStationNo,
        wo.deliveryStationNoIsv,
        wo.deliveryStationName,
        wo.orderbuyerpayablemoney,
        wo.deliveryConfirmTime,
        wo.orderNum
    FROM
        water_order wo
        LEFT JOIN order_business ob ON wo.id = ob.order_id
    WHERE
        1=1
        <if test="orderId != null">
        AND wo.id = #{orderId}
        </if>
        <if test="orderId == null">
            <if test="shoplist != null and shoplist.size() != 0">
                AND wo.deliveryStationNoIsv in
                <foreach collection="shoplist" item="id" open="(" close=")" separator=",">
                    #{id}
                </foreach>
            </if>
            <if test="idlist != null and idlist.size() != 0">
                AND wo.org_id in
                <foreach collection="idlist" item="id" open="(" close=")" separator=",">
                    #{id}
                </foreach>
            </if>
            <if test='status != null and status != ""'>
                <if test='status == "32000"'>
                    AND ((
                    ob.opt_code IS NULL
                    AND (
                    wo.orderStatus IN ( '32000', '20050', '20032' ))
                    )
                    OR (
                    ob.opt_code = 'L21'
                    AND (
                    wo.orderStatus IN ( '33040', '20050' )))
                    OR (
                    ob.opt_code = 'L25'
                    AND (
                    wo.orderStatus IN ( '33040', '20050' )))
                    OR (
                    ob.opt_code = 'L23'
                    AND (
                    wo.orderStatus IN ( '32000', '20050', '20032' ))
                    )
                    )
                </if>
                <if test='status == "20030"'>
                    AND wo.orderStatus in ('20010','20030')
                </if>
                <if test='status == "33040"'>
                    <if test="optCode == null">
                        AND (wo.orderStatus in ('33040','20050') and ob.opt_code in ('L10','L20'))
                    </if>
                    <if test="optCode != null and optCode != ''">
                        AND (wo.orderStatus in ('33040','20050') and ob.opt_code = #{optCode})
                    </if>
                </if>
                <if test='status == "33060"'>
                    AND wo.orderStatus in('33060','90000')
                    <if test='optCode != null and optCode=="L20"'>
                        AND ob.opt_code != 'L90'
                    </if>
                    <if test='optCode != null and optCode=="L90"'>
                        AND ob.opt_code = 'L90'
                    </if>
                </if>
            </if>
            <if test="searchAddress != null and searchAddress != ''">
                AND wo.buyerFullAddress like CONCAT('%',#{searchAddress},'%')
            </if>
            <if test="searchName != null and searchName != ''">
                AND wo.buyerFullName like CONCAT('%',#{searchName},'%')
            </if>
            <if test="platforms != null and platforms.size() != 0">
                AND wo.platform in
                <foreach collection="platforms" item="platform" open="(" close=")" separator=",">
                    #{platform}
                </foreach>
            </if>
            <if test="startTime != null and endTime != null">
                AND wo.orderPreEndDeliveryTime BETWEEN #{startTime} AND #{endTime}
            </if>
            <if test="startTime != null and endTime == null">
                AND #{endTime} >= wo.orderPreEndDeliveryTime
            </if>
            <if test="startTime == null and endTime != null">
                AND wo.orderPreEndDeliveryTime >= #{startTime}
            </if>
            ORDER BY
                wo.orderPreEndDeliveryTime
            <if test="offset != null and pageSize != null">
                LIMIT #{offset},#{pageSize}
            </if>
        </if>

    </select>

    <select id="getOrgOrderListForSite" parameterType="com.wx.watersupplierservice.req.OrderListReq" resultMap="OrgOrderMapForSite">
        SELECT
        wo.id,
        wo.orderId,
        wo.platform,
        wo.orderStatus,
        wo.orderStartTime,
        wo.pickDeadline,
        wo.orderPreStartDeliveryTime,
        wo.orderPreEndDeliveryTime,
        wo.orderCancelTime,
        wo.orderCancelRemark,
        wo.buyerPin,
        wo.buyerFullName,
        wo.buyerFullAddress,
        wo.buyerTelephone,
        wo.buyerMobile,
        wo.orderPayType,
        wo.orderTotalMoney,
        wo.orderGoodsMoney,
        wo.orderBuyerRemark,
        wo.deliveryStationNo,
        wo.deliveryStationNoIsv,
        wo.deliveryStationName,
        wo.orderbuyerpayablemoney,
        wo.deliveryConfirmTime,
        ob.id AS orderBusinessId,
        ob.opt_code as optCode,
        ob.remand
        FROM
        water_order wo
        INNER JOIN order_business ob ON ob.order_id = wo.id
        WHERE
        1=1
        <if test="orderBusinessId != null">
        AND ob.id = #{orderBusinessId}
        </if>
        <if test="orderId == null">
        AND ob.site_id in
            <foreach collection="idlist" item="id" open="(" close=")" separator=",">
                #{id}
            </foreach>
        </if>
        <if test="searchAddress != null and searchAddress != ''">
            AND wo.buyerFullAddress like CONCAT('%',#{searchAddress},'%')
        </if>
        <if test="searchName != null and searchName != ''">
            AND wo.buyerFullName like CONCAT('%',#{searchName},'%')
        </if>
        <if test="status != null and status != ''">
            AND ob.opt_code = #{status}
        </if>
        <if test="platforms != null and platforms.size() != 0">
            AND wo.platform in
            <foreach collection="platforms" item="platform" open="(" close=")" separator=",">
                #{platform}
            </foreach>
        </if>
        <if test="startTime != null and endTime != null">
            AND wo.orderPreEndDeliveryTime BETWEEN #{startTime} AND #{endTime}
        </if>
        <if test="startTime != null and endTime == null">
            AND #{endTime} >= wo.orderPreEndDeliveryTime
        </if>
        <if test="startTime == null and endTime != null">
            AND wo.orderPreEndDeliveryTime >= #{startTime}
        </if>
        ORDER BY
            wo.orderPreEndDeliveryTime
        <if test="offset != null and pageSize != null">
            LIMIT #{offset},#{pageSize}
        </if>
    </select>

    <update id="updateStatusById">
        UPDATE water_order
        SET orderStatus = #{code},
         version = #{version}+ 1,
         update_by = #{userId},
         update_time = now()
         <if test='code == "33060"'>
             , deliveryConfirmTime = now()
         </if>
        WHERE
            id = #{id}
        AND version = #{version}
    </update>

    <select id="getOrderSiteBeforsList" resultType="com.wx.watersupplierservice.dto.OrderDto$OrderSiteBefor">
        SELECT
            wo.id AS orderId,
            ob.site_id AS siteId,
            ss.site_name AS siteName,
            wo.buyerFullAddress AS address
        FROM
            water_order wo
        INNER JOIN order_business ob ON wo.id = ob.order_id
        INNER JOIN sys_site ss ON ob.site_id = ss.site_id
        WHERE
            buyerPin = #{custom}
        AND orderStatus in ('33060','90000')
        AND ss.site_status = '1'
        ORDER BY
            wo.create_time DESC
        LIMIT 1
    </select>

    <select id="getOrgOrderCount" parameterType="com.wx.watersupplierservice.req.OrderListReq" resultType="java.lang.Integer">
        SELECT
            count(1)
        FROM
        water_order wo
        LEFT JOIN order_business ob ON wo.id = ob.order_id
        WHERE
        1=1
        <if test="orderId != null">
            AND wo.id = #{orderId}
        </if>
        <if test="orderId == null">
            <if test="shoplist != null and shoplist.size() != 0">
                AND wo.deliveryStationNoIsv in
                <foreach collection="shoplist" item="id" open="(" close=")" separator=",">
                    #{id}
                </foreach>
            </if>
            <if test="idlist != null and idlist.size() != 0">
                AND wo.org_id in
                <foreach collection="idlist" item="id" open="(" close=")" separator=",">
                    #{id}
                </foreach>
            </if>
            <if test='status != null and status != ""'>
                <if test='status == "32000"'>
                    AND ((
                    ob.opt_code IS NULL
                    AND (
                    wo.orderStatus IN ( '32000', '20050', '20032' ))
                    )
                    OR (
                    ob.opt_code = 'L21'
                    AND (
                    wo.orderStatus IN ( '33040', '20050' )))
                    OR (
                    ob.opt_code = 'L25'
                    AND (
                    wo.orderStatus IN ( '33040', '20050' )))
                    OR (
                    ob.opt_code = 'L23'
                    AND (
                    wo.orderStatus IN ( '32000', '20050', '20032' ))
                    )
                    )
                </if>
                <if test='status == "20030"'>
                    AND wo.orderStatus in ('20010','20030')
                </if>
                <if test='status == "33040"'>
                    <if test="optCode == null">
                        AND (wo.orderStatus in ('33040','20050') and ob.opt_code in ('L10','L20'))
                    </if>
                    <if test="optCode != null and optCode != ''">
                        AND (wo.orderStatus in ('33040','20050') and ob.opt_code = #{optCode})
                    </if>
                </if>
                <if test='status == "33060"'>
                    AND wo.orderStatus in('33060','90000')
                    <if test='optCode != null and optCode=="L20"'>
                        AND ob.opt_code != 'L90'
                    </if>
                    <if test='optCode != null and optCode=="L90"'>
                        AND ob.opt_code = 'L90'
                    </if>
                </if>
            </if>
            <if test="searchAddress != null and searchAddress != ''">
                AND wo.buyerFullAddress like CONCAT('%',#{searchAddress},'%')
            </if>
            <if test="searchName != null and searchName != ''">
                AND wo.buyerFullName like CONCAT('%',#{searchName},'%')
            </if>
            <if test="platforms != null and platforms.size() != 0">
                AND wo.platform in
                <foreach collection="platforms" item="platform" open="(" close=")" separator=",">
                    #{platform}
                </foreach>
            </if>
            <if test="startTime != null and endTime != null">
                AND wo.orderPreEndDeliveryTime BETWEEN #{startTime} AND #{endTime}
            </if>
            <if test="startTime != null and endTime == null">
                AND #{endTime} >= wo.orderPreEndDeliveryTime
            </if>
            <if test="startTime == null and endTime != null">
                AND wo.orderPreEndDeliveryTime >= #{startTime}
            </if>
            <if test="offset != null and pageSize != null">
                LIMIT #{offset},#{pageSize}
            </if>
        </if>
    </select>
</mapper>